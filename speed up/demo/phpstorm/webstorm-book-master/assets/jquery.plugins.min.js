/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */(function(e){function r(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",n.wheelDelta&&(i=n.wheelDelta/120),n.detail&&(i=-n.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=-1*i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=-1*n.wheelDeltaX/120),r.unshift(t,i,o,u),(e.event.dispatch||e.event.handle).apply(this,r)}var t=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var n=t.length;n;)e.event.fixHooks[t[--n]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery),function(e,t,n){e.fn.jScrollPane=function(t){function r(t,r){function $(r){var s,g,y,E,S,T,N=!1,C=!1;i=r;if(o===n)S=t.scrollTop(),T=t.scrollLeft(),t.css({overflow:"hidden",padding:0}),u=t.innerWidth()+I,a=t.innerHeight(),t.width(u),o=e('<div class="jspPane" />').css("padding",F).append(t.children()),f=e('<div class="jspContainer" />').css({width:u+"px",height:a+"px"}).append(o).appendTo(t);else{t.css("width",""),N=i.stickToBottom&&mt(),C=i.stickToRight&&gt(),E=t.innerWidth()+I!=u||t.outerHeight()!=a,E&&(u=t.innerWidth()+I,a=t.innerHeight(),f.css({width:u+"px",height:a+"px"}));if(!E&&q==l&&o.outerHeight()==h){t.width(u);return}q=l,o.css("width",""),t.width(u),f.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}o.css("overflow","auto"),r.contentWidth?l=r.contentWidth:l=o[0].scrollWidth,h=o[0].scrollHeight,o.css("overflow",""),p=l/u,d=h/a,v=d>1,m=p>1,!m&&!v?(t.removeClass("jspScrollable"),o.css({top:0,width:f.width()-I}),bt(),St(),Tt(),rt(),Ct()):(t.addClass("jspScrollable"),s=i.maintainPosition&&(w||x),s&&(g=dt(),y=vt()),J(),Q(),Y(),s&&(ht(C?l-u:g,!1),ct(N?h-a:y,!1)),Et(),yt(),Lt(),i.enableKeyboardNavigation&&xt(),i.clickOnTrack&&nt(),Nt(),i.hijackInternalLinks&&kt()),i.autoReinitialise&&!j?j=setInterval(function(){$(i)},i.autoReinitialiseDelay):!i.autoReinitialise&&j&&clearInterval(j),S&&t.scrollTop(0)&&ct(S,!1),T&&t.scrollLeft(0)&&ht(T,!1),t.trigger("jsp-initialised",[m||v])}function J(){v&&(f.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />'))),T=f.find(">.jspVerticalBar"),N=T.find(">.jspTrack"),g=N.find(">.jspDrag"),i.showArrows&&(A=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",et(0,-1)).bind("click.jsp",wt),O=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",et(0,1)).bind("click.jsp",wt),i.arrowScrollOnHover&&(A.bind("mouseover.jsp",et(0,-1,A)),O.bind("mouseover.jsp",et(0,1,O))),Z(N,i.verticalArrowPositions,A,O)),k=a,f.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){k-=e(this).outerHeight()}),g.hover(function(){g.addClass("jspHover")},function(){g.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",wt),g.addClass("jspActive");var n=t.pageY-g.position().top;return e("html").bind("mousemove.jsp",function(e){st(e.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",it),!1}),K())}function K(){N.height(k+"px"),w=0,C=i.verticalGutter+N.outerWidth(),o.width(u-C-I);try{T.position().left===0&&o.css("margin-left",C+"px")}catch(e){}}function Q(){m&&(f.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />'))),M=f.find(">.jspHorizontalBar"),_=M.find(">.jspTrack"),E=_.find(">.jspDrag"),i.showArrows&&(H=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",et(-1,0)).bind("click.jsp",wt),B=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",et(1,0)).bind("click.jsp",wt),i.arrowScrollOnHover&&(H.bind("mouseover.jsp",et(-1,0,H)),B.bind("mouseover.jsp",et(1,0,B))),Z(_,i.horizontalArrowPositions,H,B)),E.hover(function(){E.addClass("jspHover")},function(){E.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",wt),E.addClass("jspActive");var n=t.pageX-E.position().left;return e("html").bind("mousemove.jsp",function(e){ut(e.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",it),!1}),D=f.innerWidth(),G())}function G(){f.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){D-=e(this).outerWidth()}),_.width(D+"px"),x=0}function Y(){if(m&&v){var t=_.outerHeight(),n=N.outerWidth();k-=t,e(M).find(">.jspCap:visible,>.jspArrow").each(function(){D+=e(this).outerWidth()}),D-=n,a-=n,u-=t,_.parent().append(e('<div class="jspCorner" />').css("width",t+"px")),K(),G()}m&&o.width(f.outerWidth()-I+"px"),h=o.outerHeight(),d=h/a,m&&(P=Math.ceil(1/p*D),P>i.horizontalDragMaxWidth?P=i.horizontalDragMaxWidth:P<i.horizontalDragMinWidth&&(P=i.horizontalDragMinWidth),E.width(P+"px"),S=D-P,at(x)),v&&(L=Math.ceil(1/d*k),L>i.verticalDragMaxHeight?L=i.verticalDragMaxHeight:L<i.verticalDragMinHeight&&(L=i.verticalDragMinHeight),g.height(L+"px"),y=k-L,ot(w))}function Z(e,t,n,r){var i="before",s="after",o;t=="os"&&(t=/Mac/.test(navigator.platform)?"after":"split"),t==i?s=t:t==s&&(i=t,o=n,n=r,r=o),e[i](n)[s](r)}function et(e,t,n){return function(){return tt(e,t,this,n),this.blur(),!1}}function tt(t,n,r,o){r=e(r).addClass("jspActive");var u,a,f=!0,l=function(){t!==0&&s.scrollByX(t*i.arrowButtonSpeed),n!==0&&s.scrollByY(n*i.arrowButtonSpeed),a=setTimeout(l,f?i.initialDelay:i.arrowRepeatFreq),f=!1};l(),u=o?"mouseout.jsp":"mouseup.jsp",o=o||e("html"),o.bind(u,function(){r.removeClass("jspActive"),a&&clearTimeout(a),a=null,o.unbind(u)})}function nt(){rt(),v&&N.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),o=r.offset(),u=t.pageY-o.top-w,f,l=!0,p=function(){var e=r.offset(),n=t.pageY-e.top-L/2,o=a*i.scrollPagePercent,c=y*o/(h-a);if(u<0)w-c>n?s.scrollByY(-o):st(n);else{if(!(u>0)){d();return}w+c<n?s.scrollByY(o):st(n)}f=setTimeout(p,l?i.initialDelay:i.trackClickRepeatFreq),l=!1},d=function(){f&&clearTimeout(f),f=null,e(document).unbind("mouseup.jsp",d)};return p(),e(document).bind("mouseup.jsp",d),!1}}),m&&_.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),o=r.offset(),a=t.pageX-o.left-x,f,h=!0,p=function(){var e=r.offset(),n=t.pageX-e.left-P/2,o=u*i.scrollPagePercent,c=S*o/(l-u);if(a<0)x-c>n?s.scrollByX(-o):ut(n);else{if(!(a>0)){d();return}x+c<n?s.scrollByX(o):ut(n)}f=setTimeout(p,h?i.initialDelay:i.trackClickRepeatFreq),h=!1},d=function(){f&&clearTimeout(f),f=null,e(document).unbind("mouseup.jsp",d)};return p(),e(document).bind("mouseup.jsp",d),!1}})}function rt(){_&&_.unbind("mousedown.jsp"),N&&N.unbind("mousedown.jsp")}function it(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),g&&g.removeClass("jspActive"),E&&E.removeClass("jspActive")}function st(e,t){if(!v)return;e<0?e=0:e>y&&(e=y),t===n&&(t=i.animateScroll),t?s.animate(g,"top",e,ot):(g.css("top",e),ot(e))}function ot(e){e===n&&(e=g.position().top),f.scrollTop(0),w=e;var r=w===0,i=w==y,s=e/y,u=-s*(h-a);if(R!=r||z!=i)R=r,z=i,t.trigger("jsp-arrow-change",[R,z,U,W]);ft(r,i),o.css("top",u),t.trigger("jsp-scroll-y",[-u,r,i]).trigger("scroll")}function ut(e,t){if(!m)return;e<0?e=0:e>S&&(e=S),t===n&&(t=i.animateScroll),t?s.animate(E,"left",e,at):(E.css("left",e),at(e))}function at(e){e===n&&(e=E.position().left),f.scrollTop(0),x=e;var r=x===0,i=x==S,s=e/S,a=-s*(l-u);if(U!=r||W!=i)U=r,W=i,t.trigger("jsp-arrow-change",[R,z,U,W]);lt(r,i),o.css("left",a),t.trigger("jsp-scroll-x",[-a,r,i]).trigger("scroll")}function ft(e,t){i.showArrows&&(A[e?"addClass":"removeClass"]("jspDisabled"),O[t?"addClass":"removeClass"]("jspDisabled"))}function lt(e,t){i.showArrows&&(H[e?"addClass":"removeClass"]("jspDisabled"),B[t?"addClass":"removeClass"]("jspDisabled"))}function ct(e,t){var n=e/(h-a);st(n*y,t)}function ht(e,t){var n=e/(l-u);ut(n*S,t)}function pt(t,n,r){var s,o,l,c=0,h=0,p,d,v,m,g,y;try{s=e(t)}catch(w){return}o=s.outerHeight(),l=s.outerWidth(),f.scrollTop(0),f.scrollLeft(0);while(!s.is(".jspPane")){c+=s.position().top,h+=s.position().left,s=s.offsetParent();if(/^body|html$/i.test(s[0].nodeName))return}p=vt(),v=p+a,c<p||n?g=c-i.verticalGutter:c+o>v&&(g=c-a+o+i.verticalGutter),g&&ct(g,r),d=dt(),m=d+u,h<d||n?y=h-i.horizontalGutter:h+l>m&&(y=h-u+l+i.horizontalGutter),y&&ht(y,r)}function dt(){return-o.position().left}function vt(){return-o.position().top}function mt(){var e=h-a;return e>20&&e-vt()<10}function gt(){var e=l-u;return e>20&&e-dt()<10}function yt(){f.unbind(V).bind(V,function(e,t,n,r){var o=x,u=w;return s.scrollBy(n*i.mouseWheelSpeed,-r*i.mouseWheelSpeed,!1),o==x&&u==w})}function bt(){f.unbind(V)}function wt(){return!1}function Et(){o.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){pt(e.target,!1)})}function St(){o.find(":input,a").unbind("focus.jsp")}function xt(){function l(){var e=x,t=w;switch(n){case 40:s.scrollByY(i.keyboardSpeed,!1);break;case 38:s.scrollByY(-i.keyboardSpeed,!1);break;case 34:case 32:s.scrollByY(a*i.scrollPagePercent,!1);break;case 33:s.scrollByY(-a*i.scrollPagePercent,!1);break;case 39:s.scrollByX(i.keyboardSpeed,!1);break;case 37:s.scrollByX(-i.keyboardSpeed,!1)}return r=e!=x||t!=w,r}var n,r,u=[];m&&u.push(M[0]),v&&u.push(T[0]),o.focus(function(){t.focus()}),t.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(t){if(t.target!==this&&(!u.length||!e(t.target).closest(u).length))return;var i=x,s=w;switch(t.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=t.keyCode,l();break;case 35:ct(h-a),n=null;break;case 36:ct(0),n=null}return r=t.keyCode==n&&i!=x||s!=w,!r}).bind("keypress.jsp",function(e){return e.keyCode==n&&l(),!r}),i.hideFocus?(t.css("outline","none"),"hideFocus"in f[0]&&t.attr("hideFocus",!0)):(t.css("outline",""),"hideFocus"in f[0]&&t.attr("hideFocus",!1))}function Tt(){t.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function Nt(){if(location.hash&&location.hash.length>1){var t,n,r=escape(location.hash);try{t=e(r)}catch(i){return}t.length&&o.find(r)&&(f.scrollTop()===0?n=setInterval(function(){f.scrollTop()>0&&(pt(r,!0),e(document).scrollTop(f.position().top),clearInterval(n))},50):(pt(r,!0),e(document).scrollTop(f.position().top)))}}function Ct(){e("a.jspHijack").unbind("click.jsp-hijack").removeClass("jspHijack")}function kt(){Ct(),e("a[href^=#]").addClass("jspHijack").bind("click.jsp-hijack",function(){var e=this.href.split("#"),t;if(e.length>1){t=e[1];if(t.length>0&&o.find("#"+t).length>0)return pt("#"+t,!0),!1}})}function Lt(){var e,t,n,r,i,o=!1;f.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(s){var u=s.originalEvent.touches[0];e=dt(),t=vt(),n=u.pageX,r=u.pageY,i=!1,o=!0}).bind("touchmove.jsp",function(u){if(!o)return;var a=u.originalEvent.touches[0],f=x,l=w;return s.scrollTo(e+n-a.pageX,t+r-a.pageY),i=i||Math.abs(n-a.pageX)>5||Math.abs(r-a.pageY)>5,f==x&&l==w}).bind("touchend.jsp",function(e){o=!1}).bind("click.jsp-touchclick",function(e){if(i)return i=!1,!1})}function At(){var e=vt(),n=dt();t.removeClass("jspScrollable").unbind(".jsp"),t.replaceWith(X.append(o.children())),X.scrollTop(e),X.scrollLeft(n)}var i,s=this,o,u,a,f,l,h,p,d,v,m,g,y,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R=!0,U=!0,z=!1,W=!1,X=t.clone(!1,!1).empty(),V=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";F=t.css("paddingTop")+" "+t.css("paddingRight")+" "+t.css("paddingBottom")+" "+t.css("paddingLeft"),I=(parseInt(t.css("paddingLeft"),10)||0)+(parseInt(t.css("paddingRight"),10)||0),e.extend(s,{reinitialise:function(t){t=e.extend({},i,t),$(t)},scrollToElement:function(e,t,n){pt(e,t,n)},scrollTo:function(e,t,n){ht(e,n),ct(t,n)},scrollToX:function(e,t){ht(e,t)},scrollToY:function(e,t){ct(e,t)},scrollToPercentX:function(e,t){ht(e*(l-u),t)},scrollToPercentY:function(e,t){ct(e*(h-a),t)},scrollBy:function(e,t,n){s.scrollByX(e,n),s.scrollByY(t,n)},scrollByX:function(e,t){var n=dt()+Math[e<0?"floor":"ceil"](e),r=n/(l-u);ut(r*S,t)},scrollByY:function(e,t){var n=vt()+Math[e<0?"floor":"ceil"](e),r=n/(h-a);st(r*y,t)},positionDragX:function(e,t){ut(e,t)},positionDragY:function(e,t){st(e,t)},animate:function(e,t,n,r){var s={};s[t]=n,e.animate(s,{duration:i.animateDuration,easing:i.animateEase,queue:!1,step:r})},getContentPositionX:function(){return dt()},getContentPositionY:function(){return vt()},getContentWidth:function(){return l},getContentHeight:function(){return h},getPercentScrolledX:function(){return dt()/(l-u)},getPercentScrolledY:function(){return vt()/(h-a)},getIsScrollableH:function(){return m},getIsScrollableV:function(){return v},getContentPane:function(){return o},scrollToBottom:function(e){st(y,e)},hijackInternalLinks:function(){kt()},destroy:function(){At()}}),$(r)}return t=e.extend({},e.fn.jScrollPane.defaults,t),e.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){t[this]=t[this]||t.speed}),this.each(function(){var n=e(this),i=n.data("jsp");i?i.reinitialise(t):(i=new r(n,t),n.data("jsp",i))})},e.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this),function(){var e=jQuery.event,t=function(e,t,n,r){var i,s,o,u,a,f,l,c,h;for(i=0;i<t.length;i++){s=t[i],u=s.indexOf(".")<0,u||(l=s.split("."),s=l.shift(),c=new RegExp("(^|\\.)"+l.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")),o=(e[s]||[]).slice(0);for(a=0;a<o.length;a++)f=o[a],h=u||c.test(f.namespace),h&&(r?f.selector===r&&n(s,f.origHandler||f.handler):r===null?n(s,f.origHandler||f.handler,f.selector):f.selector||n(s,f.origHandler||f.handler))}};e.find=function(e,n,r){var i=($._data(e)||{}).events,s=[],o,u,a;return i?(t(i,n,function(e,t){s.push(t)},r),s):s},e.findBySelector=function(e,n){var r=$._data(e).events,i={},s=function(e,t,n){var r=i[e]||(i[e]={}),s=r[t]||(r[t]=[]);s.push(n)};return r?(t(r,n,function(e,t,n){s(n||"",e,t)},null),i):i},e.supportTouch="ontouchend"in document,$.fn.respondsTo=function(t){return this.length?e.find(this[0],$.isArray(t)?t:[t]).length>0:!1},$.fn.triggerHandled=function(e,t){return e=typeof e=="string"?$.Event(e):e,this.trigger(e,t),e.handled},e.setupHelper=function(t,n,r){r||(r=n,n=null);var i=function(i){var s,o=i.selector||"";o?(s=e.find(this,t,o),s.length||$(this).delegate(o,n,r)):e.find(this,t,o).length||e.add(this,n,r,{selector:o,delegate:this})},s=function(i){var s,o=i.selector||"";o?(s=e.find(this,t,o),s.length||$(this).undelegate(o,n,r)):e.find(this,t,o).length||e.remove(this,n,r,{selector:o,delegate:this})};$.each(t,function(){e.special[this]={add:i,remove:s,setup:function(){},teardown:function(){}}})}}(jQuery),function(e){var t=/Phantom/.test(navigator.userAgent),n=!t&&"ontouchend"in document,r="touchmove scroll",i=n?"touchstart":"mousedown",s=n?"touchend":"mouseup",o=n?"touchmove":"mousemove",u=function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[n.pageX,n.pageY],origin:e(t.target)}},a=e.event.swipe={delay:500,max:75,min:30};e.event.setupHelper(["swipe","swipeleft","swiperight","swipeup","swipedown"],i,function(t){function c(e){if(!n)return;r=u(e),Math.abs(n.coords[0]-r.coords[0])>10&&e.preventDefault()}var n=u(t),r,i=t.delegateTarget||t.currentTarget,f=t.handleObj.selector,l=this;e(document.documentElement).bind(o,c).one(s,function(s){e(this).unbind(o,c);if(n&&r){var u=Math.abs(n.coords[0]-r.coords[0]),h=Math.abs(n.coords[1]-r.coords[1]),p=Math.sqrt(u*u+h*h);if(r.time-n.time<a.delay&&p>=a.min){var d=["swipe"];u>=a.min&&h<a.min?d.push(n.coords[0]>r.coords[0]?"swipeleft":"swiperight"):h>=a.min&&u<a.min&&d.push(n.coords[1]<r.coords[1]?"swipedown":"swipeup"),e.each(e.event.find(i,d,f),function(){this.call(l,t,{start:n,end:r})})}}n=r=undefined})})}(jQuery),function(e,t,n){"use strict";var r=e.event,i,s;i=r.special.debouncedresize={setup:function(){e(this).on("resize",i.handler)},teardown:function(){e(this).off("resize",i.handler)},handler:function(e,t){var n=this,o=arguments,u=function(){e.type="debouncedresize",r.dispatch.apply(n,o)};s&&clearTimeout(s),t?u():s=setTimeout(u,i.threshold)},threshold:150};var o=e(t),u=t.Modernizr;e.BookBlock=function(t,n){this.$el=e(n),this._init(t)},e.BookBlock.defaults={speed:1e3,easing:"ease-in-out",shadows:!0,shadowSides:.2,shadowFlip:.1,perspective:1300,circular:!1,nextEl:"",prevEl:"",autoplay:!1,interval:3e3,keyboard:!0,onEndFlip:function(e,t,n){return!1},onBeforeFlip:function(e){return!1}},e.BookBlock.prototype={_init:function(t){this.options=e.extend(!0,{},e.BookBlock.defaults,t),this.$el.css("perspective",this.options.perspective),this.$items=this.$el.children(".bb-item"),this.itemsCount=this.$items.length,this.current=0,this.previous=-1,this.$current=this.$items.eq(this.current).show(),this.elWidth=this.$el.width();var n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};this.transEndEventName=n[u.prefixed("transition")]+".bookblock",this.support=u.csstransitions&&u.csstransforms3d,this._initEvents(),this.options.autoplay&&(this.options.circular=!0,this._startSlideshow())},_initEvents:function(){var t=this;this.options.nextEl!==""&&e(this.options.nextEl).on("click.bookblock",function(){return t._action("next"),!1}),this.options.prevEl!==""&&e(this.options.prevEl).on("click.bookblock",function(){return t._action("prev"),!1}),this.options.keyboard==1&&e(document).keydown(function(e){var n=e.keyCode||e.which,r={left:37,up:38,right:39,down:40};switch(n){case r.left:t._action("prev");break;case r.right:t._action("next")}}),o.on("debouncedresize",function(){t.elWidth=t.$el.width()})},_action:function(e,t){this._stopSlideshow(),this._navigate(e,t)},_navigate:function(e,t){if(this.isAnimating)return!1;this.options.onBeforeFlip(this.current),this.isAnimating=!0,this.$current=this.$items.eq(this.current),t!==n?this.current=t:e==="next"?!this.options.circular&&this.current===this.itemsCount-1?this.end=!0:(this.previous=this.current,this.current=this.current<this.itemsCount-1?this.current+1:0):e==="prev"&&(!this.options.circular&&this.current===0?this.end=!0:(this.previous=this.current,this.current=this.current>0?this.current-1:this.itemsCount-1)),this.$nextItem=!this.options.circular&&this.end?this.$current:this.$items.eq(this.current),this.support?this._layout(e):this._layoutNoSupport(e)},_layoutNoSupport:function(e){this.$items.hide(),this.$nextItem.show(),this.end=!1,this.isAnimating=!1;var t=e==="next"&&this.current===this.itemsCount-1||e==="prev"&&this.current===0;this.options.onEndFlip(this.previous,this.current,t)},_layout:function(e){var t=this,n=this._addSide("left",e),r=this._addSide("middle",e),i=this._addSide("right",e),s=n.find("div.bb-overlay"),o=r.find("div.bb-flipoverlay:first"),u=r.find("div.bb-flipoverlay:last"),a=i.find("div.bb-overlay"),f=this.end?400:this.options.speed;this.$items.hide(),this.$el.prepend(n,r,i),r.css({transition:"all "+f+"ms "+this.options.easing}).on(this.transEndEventName,function(n){if(n.target.className==="bb-page"){t.$el.children("div.bb-page").remove(),t.$nextItem.show(),t.end=!1,t.isAnimating=!1;var r=e==="next"&&t.current===t.itemsCount-1||e==="prev"&&t.current===0;t.options.onEndFlip(t.previous,t.current,r)}}),e==="prev"&&r.css({transform:"rotateY(-180deg)"});if(this.options.shadows&&!this.end){var l=e==="next"?{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms"}:{transition:"opacity "+this.options.speed/2+"ms "+"linear",opacity:this.options.shadowSides},c=e==="next"?{transition:"opacity "+this.options.speed/2+"ms "+"linear"}:{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms",opacity:this.options.shadowFlip},h=e==="next"?{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms",opacity:this.options.shadowFlip}:{transition:"opacity "+this.options.speed/2+"ms "+"linear"},p=e==="next"?{transition:"opacity "+this.options.speed/2+"ms "+"linear",opacity:this.options.shadowSides}:{transition:"opacity "+this.options.speed/2+"ms "+"linear"+" "+this.options.speed/2+"ms"};o.css(c),u.css(h),s.css(l),a.css(p)}setTimeout(function(){var n=e==="next"?"rotateY(-180deg)":"rotateY(0deg)";t.end&&(n=e==="next"?"rotateY(-15deg)":"rotateY(-165deg)"),r.css({transform:n}),t.options.shadows&&!t.end&&(o.css({opacity:e==="next"?t.options.shadowFlip:0}),u.css({opacity:e==="next"?0:t.options.shadowFlip}),s.css({opacity:e==="next"?t.options.shadowSides:0}),a.css({opacity:e==="next"?0:t.options.shadowSides}))},30)},_addSide:function(t,n){var r;switch(t){case"left":r=e('<div class="bb-page"><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+(n==="next"?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",102);break;case"middle":r=e('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content" style="left:'+ -this.elWidth/2+"px;width:"+this.elWidth+'px"><div class="bb-inner">'+(n==="next"?this.$current.html():this.$nextItem.html())+'</div></div><div class="bb-flipoverlay"></div></div></div><div class="bb-back"><div class="bb-outer"><div class="bb-content" style="width:'+this.elWidth+'px"><div class="bb-inner">'+(n==="next"?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-flipoverlay"></div></div></div></div>').css("z-index",103);break;case"right":r=e('<div class="bb-page"><div class="bb-front"><div class="bb-outer"><div class="bb-content" style="left:'+ -this.elWidth/2+"px;width:"+this.elWidth+'px"><div class="bb-inner">'+(n==="next"?this.$nextItem.html():this.$current.html())+'</div></div><div class="bb-overlay"></div></div></div></div>').css("z-index",101)}return r},_startSlideshow:function(){var e=this;this.slideshow=setTimeout(function(){e._navigate("next"),e.options.autoplay&&e._startSlideshow()},this.options.interval)},_stopSlideshow:function(){this.options.autoplay&&(clearTimeout(this.slideshow),this.options.autoplay=!1)},next:function(){this._action("next")},prev:function(){this._action("prev")},jump:function(e){e-=1;if(e===this.current||e>=this.itemsCount||e<0)return!1;this._action(e>this.current?"next":"prev",e)},isActive:function(){return this.isAnimating},update:function(){var e=this.$items.eq(this.current);this.$items=this.$el.children(".bb-item"),this.itemsCount=this.$items.length,this.current=e.index()}};var a=function(e){t.console&&t.console.error(e)};e.fn.bookblock=function(t){var n=e.data(this,"bookblock");if(typeof t=="string"){var r=Array.prototype.slice.call(arguments,1);this.each(function(){if(!n){a("cannot call methods on bookblock prior to initialization; attempted to call method '"+t+"'");return}if(!e.isFunction(n[t])||t.charAt(0)==="_"){a("no such method '"+t+"' for bookblock instance");return}n[t].apply(n,r)})}else this.each(function(){n?n._init():n=e.data(this,"bookblock",new e.BookBlock(t,this))});return n}}(jQuery,window);